<!DOCTYPE html>
<html lang="en" class="dark"> <!-- Default to dark theme -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIDEFEND Framework Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            /* Light Theme */
            --bg-color: #f0f2f5;
            --text-color: #37474f;
            --text-secondary-color: #607d8b;
            --header-bg: #ffffff;
            --header-border: #e0e0e0;
            --column-bg: #ffffff;
            --column-border: #e0e0e0;
            --column-header-text: #455a64;
            --column-header-hover-text: #1976d2;
            --technique-item-bg: #ffffff;
            --technique-item-border: #e8eaf6;
            --technique-item-text: #2196f3;
            --technique-item-hover-bg: #e3f2fd;
            --technique-item-hover-text: #1565c0;
            --technique-item-highlight-bg: #bbdefb;
            --technique-item-highlight-text: #0d47a1;
            --technique-id-text: #78909c;
            --modal-content-bg: #ffffff;
            --modal-close-btn-text: #757575;
            --modal-close-btn-hover-text: #212121;
            --search-bg: #eceff1;
            --search-border: #b0bec5;
            --search-focus-ring: #2196f3;
            --scrollbar-track: #e0e0e0;
            --scrollbar-thumb: #90a4ae;
            --scrollbar-thumb-hover: #78909c;
            --icon-fill: #607d8b;
            --icon-hover-fill: #2196f3;
            --link-color: #1976d2;
            --link-hover-color: #0d47a1;
            --shadow-umbra: rgba(0, 0, 0, 0.15);
            --shadow-penumbra: rgba(0, 0, 0, 0.1);
            --shadow-ambient: rgba(0, 0, 0, 0.08);
            --footer-bg: #e0e0e0;
            --footer-text: #757575;
            --footer-border: #c0c0c0;
        }
        html.dark {
            /* Dark Theme */
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --text-secondary-color: #b0b0b0;
            --header-bg: #222222;
            --header-border: #333333;
            --column-bg: #222222;
            --column-border: #333333;
            --column-header-text: #f0f0f0;
            --column-header-hover-text: #90caf9;
            --technique-item-bg: #2b2b2b;
            --technique-item-border: #3d3d3d;
            --technique-item-text: #90caf9;
            --technique-item-hover-bg: #383838;
            --technique-item-hover-text: #bbdefb;
            --technique-item-highlight-bg: #1e3a5f;
            --technique-item-highlight-text: #e3f2fd;
            --technique-id-text: #c0c0c0;
            --modal-content-bg: #222222;
            --modal-close-btn-text: #b0b0b0;
            --modal-close-btn-hover-text: #f0f0f0;
            --search-bg: #333333;
            --search-border: #444444;
            --search-focus-ring: #90caf9;
            --scrollbar-track: #2b2b2b;
            --scrollbar-thumb: #555555;
            --scrollbar-thumb-hover: #777777;
            --icon-fill: #c0c0c0;
            --icon-hover-fill: #90caf9;
            --link-color: #90caf9;
            --link-hover-color: #e3f2fd;
            --shadow-umbra: rgba(0, 0, 0, 0.5);
            --shadow-penumbra: rgba(0, 0, 0, 0.35);
            --shadow-ambient: rgba(0, 0, 0, 0.3);
            --footer-bg: #2b2b2b;
            --footer-text: #a0a0a0;
            --footer-border: #3d3d3d;
        }

        html { height: 100%; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }

        #page-container { flex: 1 0 auto; }
        footer { flex-shrink: 0; }
        body.modal-open { overflow: hidden; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--scrollbar-track); border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--scrollbar-thumb-hover); }

        .elevation-2 { box-shadow: 0px 3px 1px -2px var(--shadow-umbra), 0px 2px 2px 0px var(--shadow-penumbra), 0px 1px 5px 0px var(--shadow-ambient); }
        .elevation-4 { box-shadow: 0px 2px 4px -1px var(--shadow-umbra), 0px 4px 5px 0px var(--shadow-penumbra), 0px 1px 10px 0px var(--shadow-ambient); }
        .elevation-8 { box-shadow: 0px 5px 5px -3px var(--shadow-umbra), 0px 8px 10px 1px var(--shadow-penumbra), 0px 3px 14px 2px var(--shadow-ambient); }

        .header-main {
            background-color: var(--header-bg);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .header-title { font-size: 2rem; font-weight: 500; color: var(--text-color); }
        .header-subtitle { font-size: 0.875rem; color: var(--text-secondary-color); }

        .search-input-wrapper { position: relative; display: flex; align-items: center; }

        .search-container input {
            background-color: var(--search-bg);
            border: 1px solid var(--search-border);
            color: var(--text-color);
            border-radius: 0.5rem;
            padding-right: 2.5rem;
        }

        .search-container input::placeholder { color: var(--text-secondary-color); }

        .search-container input:focus {
            --tw-ring-color: var(--search-focus-ring);
            border-color: var(--search-focus-ring);
            box-shadow: 0 0 0 2px var(--search-focus-ring);
        }

        .search-clear-button {
            position: absolute;
            right: 0.5rem;
            padding: 0.25rem;
            color: var(--text-secondary-color);
            cursor: pointer;
            display: none;
        }

        .search-clear-button:hover { color: var(--text-color); }
        .search-clear-button svg { width: 1.25rem; height: 1.25rem; }

        .header-button {
            background-color: transparent;
            color: var(--icon-fill);
            border: none;
            padding: 0.625rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-button:hover {
            background-color: rgba(0, 0, 0, 0.04);
            color: var(--icon-hover-fill);
        }

        html.dark .header-button:hover { background-color: rgba(255, 255, 255, 0.08); }

        .header-button svg {
            width: 1.5rem;
            height: 1.5rem;
            fill: currentColor;
            margin-right: 0;
        }

        .header-button.text-button {
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: 500;
        }

        .header-button.text-button svg {
            margin-right: 0.5rem;
            width: 1.25rem;
            height: 1.25rem;
        }

        .tactic-column-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 0.28rem;
            padding: 1.5rem 0.5rem;
            align-items: flex-start;
            justify-content: center;
        }

        .tactic-column {
            flex-grow: 1;
            flex-shrink: 1;
            flex-basis: 160px;
            max-width: 210px;
            background-color: var(--column-bg);
            border-radius: 0.75rem;
            padding: 0.8rem;
            min-height: 200px;
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .tactic-column-header {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--column-header-text);
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--column-border);
            transition: color 0.3s ease, border-color 0.3s ease;
            cursor: pointer;
            text-align: center;
        }

        .tactic-column-header:hover { color: var(--column-header-hover-text); }

        .technique-item {
            display: block;
            background-color: var(--technique-item-bg);
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            color: var(--technique-item-text);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, transform 0.2s ease, box-shadow 0.2s ease;
            line-height: 1.5;
            margin-bottom: 0.75rem;
        }

        .technique-item:hover {
            background-color: var(--technique-item-hover-bg);
            color: var(--technique-item-hover-text);
            transform: translateY(-2px);
        }

        .technique-item.highlight {
            background-color: var(--technique-item-highlight-bg);
            color: var(--technique-item-highlight-text);
            font-weight: 600;
        }

        .technique-id {
            font-weight: 500;
            color: var(--technique-id-text);
            font-size: 0.75rem;
            margin-right: 0.35rem;
            display: block;
            margin-bottom: 0.125rem;
        }

        .technique-name { font-weight: 500; }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }

        html.dark .modal-overlay { background-color: rgba(0, 0, 0, 0.7); }
        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-content {
            background-color: var(--modal-content-bg);
            color: var(--text-color);
            padding: 2rem;
            border-radius: 0.5rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            transform: scale(0.95);
        }

        .modal-overlay.active .modal-content { transform: scale(1); }

        .modal-content h2.modal-main-title {
            font-size: 1.75rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            color: var(--column-header-hover-text);
        }

        .modal-content h2 {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--column-header-hover-text);
        }

        .modal-content h3 {
            font-size: 1.25rem;
            font-weight: 500;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-color);
        }

        .modal-content h4 {
            font-size: 1rem;
            font-weight: 500;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        .modal-content h5 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 0.75rem;
            margin-bottom: 0.25rem;
            color: var(--text-color);
        }

        .modal-content p {
            font-size: 0.9375rem;
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .modal-content ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            font-size: 0.9375rem;
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .modal-content ul ul {
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .modal-content li { margin-bottom: 0.375rem; }

        .modal-content a {
            color: var(--link-color);
            text-decoration: none;
            font-weight: 500;
        }

        .modal-content a:hover {
            color: var(--link-hover-color);
            text-decoration: underline;
        }

        .modal-content code {
            font-family: monospace;
            background-color: var(--search-bg);
            padding: 0.1rem 0.3rem;
            border-radius: 0.25rem;
            font-size: 0.8rem;
        }

        .modal-content pre {
            background-color: var(--search-bg);
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
            overflow-x: auto;
        }

        .modal-content pre code {
            padding: 0;
            background: none;
        }

        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.75rem;
            color: var(--modal-close-btn-text);
            cursor: pointer;
            line-height: 1;
            transition: color 0.3s ease;
            padding: 0.25rem;
        }

        .modal-close-button:hover { color: var(--modal-close-btn-hover-text); }

        .defends-against-framework {
            font-weight: 500;
            color: var(--technique-item-text);
            opacity: 0.9;
        }

        .site-footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            padding: 1rem 1rem;
            text-align: center;
            font-size: 0.875rem;
            border-top: 1px solid var(--footer-border);
            margin-top: auto;
        }

        .site-footer p {
            margin-bottom: 0.25rem;
            line-height: 1.5;
        }

        .accordion-item { border-bottom: 1px solid var(--header-border); }

        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 0.5rem;
            cursor: pointer;
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--text-color);
            transition: color 0.2s ease;
        }

        .accordion-header:hover { color: var(--column-header-hover-text); }

        .accordion-icon {
            width: 1.25rem;
            height: 1.25rem;
            transition: transform 0.3s ease-in-out;
            flex-shrink: 0;
            margin-left: 1rem;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
            font-size: 0.9375rem;
            line-height: 1.7;
            color: var(--text-secondary-color);
        }

        .accordion-content-inner { padding: 0 0.5rem 1.25rem 0.5rem; }

        .strategy-accordion-container { margin-top: 0.5rem; }
        .strategy-accordion-item { border-bottom: 1px solid var(--column-border); }

        .strategy-accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .strategy-accordion-header:hover { color: var(--technique-item-hover-text); }

        .strategy-accordion-icon {
            width: 1rem;
            height: 1rem;
            transition: transform 0.3s ease-in-out;
            flex-shrink: 0;
            margin-left: 0.5rem;
        }

        .strategy-accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }

        .strategy-accordion-content-inner {
            padding: 0.5rem 0.5rem 1rem 1rem;
            font-size: 0.85rem;
            line-height: 1.6;
            color: var(--text-secondary-color);
        }

        .perf-impact-note {
            background-color: #f0f4f8;
            border-left: 4px solid #4a90e2;
            padding: 12px 18px;
            margin: 16px 0;
            border-radius: 4px;
            font-size: 0.9em;
            line-height: 1.6;
        }

        html.dark .perf-impact-note {
            background-color: #2c3e50;
            border-left-color: #5dade2;
        }

        .perf-impact-note p { margin: 0; padding: 0; }
        .perf-impact-note strong { color: var(--text-color); }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="text-gray-800">
    <div id="page-container">
        <header class="header-main py-4 px-6 fixed top-0 left-0 right-0 z-50 elevation-4">
            <div class="container mx-auto">
                <div class="flex justify-between items-center mb-3">
                    <div class="text-left">
                        <h1 class="header-title">AIDEFEND™</h1>
                        <p class="header-subtitle">An AI-focused defensive countermeasures knowledge base</p>
                        <p class="text-xs opacity-60 mt-0.5 header-version-text">Version 1.0</p>
                    </div>
                    <div class="flex items-center space-x-1">
                        <button id="aboutBtn" class="header-button text-button" title="About AIDEFEND">
                            About
                        </button>
                        <button id="themeToggleBtn" class="header-button" title="Toggle Theme">
                        </button>
                    </div>
                </div>
                <div class="search-input-wrapper search-container">
                    <input type="text" id="search-bar"
                        placeholder="Search keywords, AIDEFEND/ATLAS techniques, MAESTRO threats, OWASP Top10s, etc..."
                        class="w-full p-2.5 text-sm">
                    <button id="searchClearBtn" class="search-clear-button" title="Clear search">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16ZM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22Z"
                                clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <div id="content-wrapper" class="pt-44 px-4 sm:px-6 lg:px-8 pb-8">
            <main id="main-content" class="container mx-auto"></main>
        </div>
    </div>

    <div id="infoModal" class="modal-overlay">
        <div id="modalBackdrop" class="absolute inset-0"></div>
        <div class="modal-content elevation-8">
            <button id="modalClose" class="modal-close-button">&times;</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <footer class="site-footer">
        <p>AIDEFEND, An AI-focused defensive countermeasures knowledge base.</p>
        <p>Information based on the <a
                href="https://cloudsecurityalliance.org/blog/2025/02/06/agentic-ai-threat-modeling-framework-maestro"
                target="_blank" rel="noopener noreferrer" class="text-sky-600 dark:text-sky-400 hover:underline">MAESTRO
                framework</a>, <a href="https://d3fend.mitre.org/" target="_blank" rel="noopener noreferrer"
                class="text-sky-600 dark:text-sky-400 hover:underline">MITRE D3FEND</a>, <a
                href="https://atlas.mitre.org/" target="_blank" rel="noopener noreferrer"
                class="text-sky-600 dark:text-sky-400 hover:underline">ATLAS</a>, <a href="https://attack.mitre.org/"
                target="_blank" rel="noopener noreferrer"
                class="text-sky-600 dark:text-sky-400 hover:underline">ATT&CK</a>, and <a
                href="https://owasp.org/www-project-top-10-for-large-language-model-applications/" target="_blank"
                rel="noopener noreferrer" class="text-sky-600 dark:text-sky-400 hover:underline">OWASP Top 10 LLM
                2025</a>/<a href="https://owasp.org/www-project-machine-learning-security-top-10/" target="_blank"
                rel="noopener noreferrer" class="text-sky-600 dark:text-sky-400 hover:underline">OWASP Top 10 ML
                Security 2023</a>.</p>
        <p>2025 Edward's Playground - AIDEFEND framework Initiative. For informational purposes only.</p>
        <p>All content on this website is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/"
                target="_blank" rel="noopener noreferrer"
                class="text-sky-600 dark:text-sky-400 hover:underline">Creative Commons Attribution 4.0 International
                License (CC BY 4.0)</a></p>
    </footer>
    <script src="aidefend-data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const elements = {
                mainContent: document.getElementById('main-content'),
                searchBar: document.getElementById('search-bar'),
                searchClearBtn: document.getElementById('searchClearBtn'),
                modal: document.getElementById('infoModal'),
                modalBackdrop: document.getElementById('modalBackdrop'),
                modalBody: document.getElementById('modalBody'),
                modalClose: document.getElementById('modalClose'),
                themeToggleBtn: document.getElementById('themeToggleBtn'),
                aboutBtn: document.getElementById('aboutBtn'),
                html: document.documentElement
            };

            // SVG icons
            const icons = {
                plus: `<svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>`,
                minus: `<svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 10a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H4.75A.75.75 0 014 10z" clip-rule="evenodd" /></svg>`,
                sun: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.166 7.758a.75.75 0 001.06 1.06l1.591-1.59a.75.75 0 00-1.06-1.061L6.166 7.758z" /></svg>`,
                moon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-3.51 1.713-6.636 4.362-8.492a.75.75 0 01.819.162z" clip-rule="evenodd" /></svg>`,
                info: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM9 9a.75.75 0 0 0 0 1.5h.253a.25.25 0 0 1 .244.304l-.459 2.066A1.75 1.75 0 0 0 10.747 15H11a.75.75 0 0 0 0-1.5h-.253a.25.25 0 0 1-.244-.304l.459-2.066A1.75 1.75 0 0 0 9.253 9H9Z" clip-rule="evenodd" /></svg>`,
                strategyPlus: `<svg class="strategy-accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>`,
                strategyMinus: `<svg class="strategy-accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 10a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H4.75A.75.75 0 014 10z" clip-rule="evenodd" /></svg>`
            };

            let currentSearchTerm = "";

            // Utility Functions
            function clearElement(element) {
                while (element.firstChild) {
                    element.removeChild(element.firstChild);
                }
            }

            function createElement(tagName, options = {}) {
                const element = document.createElement(tagName);
                
                if (options.className) element.className = options.className;
                if (options.textContent) element.textContent = options.textContent;
                if (options.title) element.title = options.title;
                if (options.href) element.href = options.href;
                if (options.onclick) element.addEventListener('click', options.onclick);
                
                return element;
            }

            function setIcon(element, iconKey) {
                if (icons[iconKey]) {
                    element.innerHTML = icons[iconKey];
                }
            }

            // Safe HTML renderer for limited HTML tags
            function renderSafeHTML(htmlString, container) {
                if (!htmlString) return;

                // Allowlist of safe HTML tags and their attributes
                const allowedTags = {
                    'p': [],
                    'h3': [],
                    'h4': [],
                    'h5': [],
                    'ul': [],
                    'ol': [],
                    'li': [],
                    'strong': [],
                    'em': [],
                    'br': [],
                    'code': [],
                    'pre': []
                };

                // Simple HTML parser that only creates allowed elements
                const parser = new DOMParser();
                const doc = parser.parseFromString(`<div>${htmlString}</div>`, 'text/html');
                const parsed = doc.body.firstChild;

                function processNode(node, parent) {
                    if (node.nodeType === Node.TEXT_NODE) {
                        parent.appendChild(document.createTextNode(node.textContent));
                    } else if (node.nodeType === Node.ELEMENT_NODE) {
                        const tagName = node.tagName.toLowerCase();
                        
                        if (allowedTags[tagName]) {
                            const newElement = document.createElement(tagName);
                            
                            // Process child nodes
                            Array.from(node.childNodes).forEach(child => {
                                processNode(child, newElement);
                            });
                            
                            parent.appendChild(newElement);
                        } else {
                            // If tag not allowed, just process its children
                            Array.from(node.childNodes).forEach(child => {
                                processNode(child, parent);
                            });
                        }
                    }
                }

                Array.from(parsed.childNodes).forEach(child => {
                    processNode(child, container);
                });
            }

            // Theme Management
            function applyTheme(theme) {
                if (theme === 'dark') {
                    elements.html.classList.add('dark');
                    setIcon(elements.themeToggleBtn, 'sun');
                } else {
                    elements.html.classList.remove('dark');
                    setIcon(elements.themeToggleBtn, 'moon');
                }
            }

            function toggleTheme() {
                const currentTheme = elements.html.classList.contains('dark') ? 'dark' : 'light';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('aidefendTheme', newTheme);
                applyTheme(newTheme);
            }

            // Search and Grid Rendering
            function getFilteredTechniques(searchTerm) {
                if (!searchTerm) return [];
                
                return aidefendData.tactics.reduce((acc, tactic) => {
                    if (tactic.techniques && Array.isArray(tactic.techniques)) {
                        tactic.techniques.forEach(tech => {
                            if (matchesTechnique(tech, searchTerm)) {
                                acc.push({ ...tech, tacticName: tactic.name });
                            }
                        });
                    }
                    return acc;
                }, []);
            }

            function matchesTechnique(tech, searchTerm) {
                const term = searchTerm.toLowerCase();
                let match = tech.name.toLowerCase().includes(term) ||
                    tech.id.toLowerCase().includes(term) ||
                    (tech.description && tech.description.toLowerCase().includes(term));
                
                if (!match && tech.defendsAgainst) {
                    match = tech.defendsAgainst.some(da => 
                        da.items && da.items.some(item => item.toLowerCase().includes(term))
                    );
                }
                
                return match;
            }

            function renderMainGrid(searchTerm = "") {
                clearElement(elements.mainContent);
                
                const gridContainer = createElement('div', { className: 'tactic-column-grid' });
                const filteredTechniques = getFilteredTechniques(searchTerm);

                if (searchTerm && filteredTechniques.length === 0) {
                    const noResults = createElement('p', {
                        className: 'text-center opacity-80 py-10',
                        textContent: `No techniques found matching "${searchTerm}".`
                    });
                    elements.mainContent.appendChild(noResults);
                    return;
                }

                aidefendData.tactics.forEach(tactic => {
                    const shouldRenderColumn = !searchTerm || (
                        tactic.techniques && 
                        tactic.techniques.some(tech => 
                            filteredTechniques.some(filtered => filtered.id === tech.id)
                        )
                    );

                    if (!shouldRenderColumn) return;

                    const column = createElement('div', { className: 'tactic-column elevation-2' });
                    
                    const header = createElement('h3', {
                        className: 'tactic-column-header',
                        textContent: tactic.name,
                        onclick: () => showTacticModal(tactic)
                    });
                    
                    column.appendChild(header);
                    column.appendChild(renderTechniqueList(tactic, searchTerm, filteredTechniques));
                    gridContainer.appendChild(column);
                });

                elements.mainContent.appendChild(gridContainer);
            }

            function renderTechniqueList(tactic, searchTerm, filteredTechniques) {
                const ul = createElement('ul');
                const techniques = searchTerm ? 
                    tactic.techniques.filter(t => filteredTechniques.some(f => f.id === t.id)) :
                    (tactic.techniques || []);

                if (techniques.length > 0) {
                    techniques.forEach(tech => {
                        ul.appendChild(renderTechniqueItem(tech, tactic.name, searchTerm, filteredTechniques));
                    });
                } else if (!searchTerm && (!tactic.techniques || tactic.techniques.length === 0)) {
                    const emptyMsg = createElement('p', {
                        className: 'text-xs opacity-60 italic px-2',
                        textContent: 'No techniques defined yet for this tactic.'
                    });
                    ul.appendChild(emptyMsg);
                }

                return ul;
            }

            function renderTechniqueItem(tech, tacticName, searchTerm, filteredTechniques) {
                const li = createElement('li');
                const link = createElement('a', {
                    href: '#',
                    className: 'technique-item elevation-2',
                    onclick: (e) => {
                        e.preventDefault();
                        showTechniqueModal(tech, tacticName);
                    }
                });

                const idSpan = createElement('span', { className: 'technique-id', textContent: tech.id });
                const nameSpan = createElement('span', { className: 'technique-name', textContent: tech.name });

                link.appendChild(idSpan);
                link.appendChild(document.createTextNode(' '));
                link.appendChild(nameSpan);

                if (searchTerm && filteredTechniques.some(f => f.id === tech.id)) {
                    link.classList.add('highlight');
                }

                li.appendChild(link);

                if (tech.subTechniques && tech.subTechniques.length > 0) {
                    const subList = createElement('ul', { className: 'pl-3 pr-1 py-1 mt-1 space-y-2' });
                    tech.subTechniques.forEach(subTech => {
                        subList.appendChild(renderSubTechniqueItem(subTech, tacticName, searchTerm));
                    });
                    li.appendChild(subList);
                }

                return li;
            }

            function renderSubTechniqueItem(subTech, tacticName, searchTerm) {
                const subLi = createElement('li');
                const subLink = createElement('a', {
                    href: '#',
                    className: 'technique-item elevation-2 block !bg-[var(--technique-item-hover-bg)] !text-[var(--technique-item-hover-text)]',
                    onclick: (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        showTechniqueModal(subTech, tacticName);
                    }
                });

                const subIdSpan = createElement('span', { 
                    className: 'technique-id !text-[var(--technique-id-text)]', 
                    textContent: subTech.id 
                });
                const subNameSpan = createElement('span', { 
                    className: 'technique-name', 
                    textContent: subTech.name 
                });

                subLink.appendChild(subIdSpan);
                subLink.appendChild(document.createTextNode(' '));
                subLink.appendChild(subNameSpan);

                if (searchTerm) subLink.classList.add('highlight');
                subLi.appendChild(subLink);
                return subLi;
            }

            // Modal Functions
            function showModal() {
                elements.modal.classList.add('active');
                document.body.classList.add('modal-open');
            }

            function hideModal() {
                elements.modal.classList.remove('active');
                document.body.classList.remove('modal-open');
                clearElement(elements.modalBody);
            }

            function createAccordion(sections, defaultOpenIndex = 0) {
                const container = createElement('div', { className: 'accordion-container' });

                sections.forEach((section, index) => {
                    const item = createElement('div', { className: 'accordion-item' });
                    const header = createElement('div', { 
                        className: 'accordion-header',
                        onclick: () => toggleAccordion(header, content, iconWrapper)
                    });
                    
                    header.setAttribute('role', 'button');
                    header.setAttribute('aria-expanded', index === defaultOpenIndex ? 'true' : 'false');

                    const title = createElement('span', { textContent: section.title });
                    const iconWrapper = createElement('div', { className: 'icon-wrapper' });

                    header.appendChild(title);
                    header.appendChild(iconWrapper);

                    const content = createElement('div', { className: 'accordion-content' });
                    const contentInner = createElement('div', { className: 'accordion-content-inner' });

                    // Add content to accordion
                    if (section.paragraphs) {
                        section.paragraphs.forEach(p => {
                            const paragraph = createElement('p');
                            renderSafeHTML(p, paragraph);
                            contentInner.appendChild(paragraph);
                        });
                    }

                    if (section.listItems) {
                        const ul = createElement('ul');
                        section.listItems.forEach(item => {
                            const li = createElement('li');
                            renderSafeHTML(item, li);
                            ul.appendChild(li);
                        });
                        contentInner.appendChild(ul);
                    }

                    if (section.concludingParagraphs) {
                        section.concludingParagraphs.forEach(p => {
                            const paragraph = createElement('p');
                            renderSafeHTML(p, paragraph);
                            contentInner.appendChild(paragraph);
                        });
                    }

                    content.appendChild(contentInner);
                    item.appendChild(header);
                    item.appendChild(content);
                    container.appendChild(item);

                    // Set initial state - open first section by default
                    if (index === defaultOpenIndex) {
                        header.classList.add('active');
                        setIcon(iconWrapper, 'minus');
                        // Set initial expansion after DOM is rendered
                        setTimeout(() => {
                            content.style.maxHeight = content.scrollHeight + 'px';
                        }, 0);
                    } else {
                        setIcon(iconWrapper, 'plus');
                    }
                });

                return container;
            }

            function toggleAccordion(header, content, iconWrapper) {
                const container = header.closest('.accordion-container');
                const isActive = header.classList.contains('active');
                
                // Close all accordion items in this container
                container.querySelectorAll('.accordion-header').forEach(otherHeader => {
                    otherHeader.classList.remove('active');
                    otherHeader.nextElementSibling.style.maxHeight = null;
                    const otherIcon = otherHeader.querySelector('.icon-wrapper');
                    setIcon(otherIcon, 'plus');
                });

                // Open this one if it wasn't active
                if (!isActive) {
                    header.classList.add('active');
                    content.style.maxHeight = content.scrollHeight + 'px';
                    setIcon(iconWrapper, 'minus');
                }
            }

            function showIntroductionModal() {
                clearElement(elements.modalBody);

                const intro = aidefendData.introduction;
                const title = createElement('h2', { 
                    className: 'modal-main-title', 
                    textContent: intro.mainTitle 
                });

                elements.modalBody.appendChild(title);
                elements.modalBody.appendChild(createAccordion(intro.sections, 0)); // Open first section by default
                showModal();
            }

            function showTacticModal(tactic) {
                clearElement(elements.modalBody);

                const fullTactic = aidefendData.tactics.find(t => t.name === tactic.name) || tactic;
                
                const title = createElement('h2', { textContent: fullTactic.name });
                const description = createElement('p', {
                    className: 'mb-4 leading-relaxed text-sm',
                    textContent: fullTactic.purpose || 'No purpose description available.'
                });

                elements.modalBody.appendChild(title);
                elements.modalBody.appendChild(description);
                showModal();
            }

            function showTechniqueModal(technique, tacticName) {
                clearElement(elements.modalBody);

                // Basic info
                const tacticInfo = createElement('p', {
                    className: 'text-sm opacity-80 mb-1',
                    textContent: `Tactic: ${tacticName}`
                });

                const title = createElement('h2', {
                    textContent: `${technique.id}: ${technique.name}`
                });

                const description = createElement('p', {
                    className: 'mb-4 leading-relaxed text-sm',
                    textContent: technique.description || 'No description available.'
                });

                elements.modalBody.appendChild(tacticInfo);
                elements.modalBody.appendChild(title);
                elements.modalBody.appendChild(description);

                // Performance impact
                if (technique.perfImpact) {
                    const perfDiv = createElement('div', { className: 'perf-impact-note' });
                    const perfP = createElement('p');
                    const strong = createElement('strong', {
                        textContent: `💡 Performance Impact (${technique.perfImpact.level}): `
                    });
                    
                    perfP.appendChild(strong);
                    
                    // Create a span for the description and render HTML safely
                    const descSpan = createElement('span');
                    renderSafeHTML(technique.perfImpact.description, descSpan);
                    perfP.appendChild(descSpan);
                    
                    perfDiv.appendChild(perfP);
                    elements.modalBody.appendChild(perfDiv);
                }

                // Implementation strategies
                renderDetailSection('Implementation Strategies', technique.implementationStrategies);
                renderDetailSection('Potential Tools - Open Source', technique.toolsOpenSource);
                renderDetailSection('Potential Tools - Commercial', technique.toolsCommercial);

                // Defends against
                renderDefendsAgainstSection(technique.defendsAgainst);
                showModal();
            }

            function renderDetailSection(title, items) {
                if (!items || items.length === 0) return;

                if (typeof items[0] === 'object' && items[0]?.strategy) {
                    renderStrategySection(title, items);
                } else {
                    renderSimpleListSection(title, items);
                }
            }

            function renderStrategySection(title, strategies) {
                const section = createElement('div', { className: 'mt-4' });
                const sectionTitle = createElement('h3', {
                    className: 'font-semibold text-lg mb-2',
                    textContent: title + ':'
                });

                const container = createElement('div', { className: 'strategy-accordion-container' });

                strategies.forEach(strategy => {
                    const item = createElement('div', { className: 'strategy-accordion-item' });
                    const header = createElement('div', {
                        className: 'strategy-accordion-header',
                        onclick: () => toggleStrategyAccordion(header, content, iconWrapper)
                    });
                    
                    header.setAttribute('role', 'button');

                    const strategyTitle = createElement('span', { textContent: strategy.strategy });
                    const iconWrapper = createElement('div', { className: 'icon-wrapper' });
                    setIcon(iconWrapper, 'strategyPlus');

                    header.appendChild(strategyTitle);
                    header.appendChild(iconWrapper);

                    const content = createElement('div', { className: 'strategy-accordion-content' });
                    const contentInner = createElement('div', { className: 'strategy-accordion-content-inner' });

                    if (strategy.howTo) {
                        renderSafeHTML(strategy.howTo, contentInner);
                    } else {
                        contentInner.appendChild(createElement('p', { textContent: 'No detailed steps provided.' }));
                    }

                    content.appendChild(contentInner);
                    item.appendChild(header);
                    item.appendChild(content);
                    container.appendChild(item);
                });

                section.appendChild(sectionTitle);
                section.appendChild(container);
                elements.modalBody.appendChild(section);
            }

            function toggleStrategyAccordion(header, content, iconWrapper) {
                const isActive = header.classList.toggle('active');
                setIcon(iconWrapper, isActive ? 'strategyMinus' : 'strategyPlus');
                content.style.maxHeight = isActive ? content.scrollHeight + "px" : null;
            }

            function renderSimpleListSection(title, items) {
                const section = createElement('div', { className: 'mt-3' });
                const sectionTitle = createElement('h4', {
                    className: 'font-semibold text-sm mb-1',
                    textContent: title + ':'
                });

                const ul = createElement('ul', {
                    className: 'list-disc list-inside ml-4 text-xs opacity-90 space-y-1'
                });

                items.forEach(item => {
                    const li = createElement('li', { textContent: item });
                    ul.appendChild(li);
                });

                section.appendChild(sectionTitle);
                section.appendChild(ul);
                elements.modalBody.appendChild(section);
            }

            function renderDefendsAgainstSection(defendsAgainst) {
                const section = createElement('div', { className: 'mt-4' });
                const title = createElement('h4', {
                    className: 'font-semibold text-md mb-2',
                    textContent: 'Defends Against:'
                });

                section.appendChild(title);

                if (defendsAgainst && defendsAgainst.length > 0) {
                    defendsAgainst.forEach(da => {
                        const daDiv = createElement('div', { className: 'mb-2' });
                        const framework = createElement('p', {
                            className: 'defends-against-framework text-sm',
                            textContent: da.framework + ':'
                        });

                        const itemsList = createElement('ul', {
                            className: 'list-disc list-inside ml-4 text-xs opacity-90 space-y-0.5'
                        });

                        da.items.forEach(item => {
                            const li = createElement('li', { textContent: item });
                            itemsList.appendChild(li);
                        });

                        daDiv.appendChild(framework);
                        daDiv.appendChild(itemsList);
                        section.appendChild(daDiv);
                    });
                } else {
                    const noDefenses = createElement('p', {
                        className: 'text-xs opacity-60 italic',
                        textContent: 'No specific defenses listed.'
                    });
                    section.appendChild(noDefenses);
                }

                elements.modalBody.appendChild(section);
            }

            // Event Listeners
            elements.themeToggleBtn.addEventListener('click', toggleTheme);
            elements.aboutBtn.addEventListener('click', showIntroductionModal);
            
            elements.searchBar.addEventListener('input', (e) => {
                currentSearchTerm = e.target.value.trim();
                elements.searchClearBtn.style.display = currentSearchTerm ? 'block' : 'none';
                renderMainGrid(currentSearchTerm);
            });
            
            elements.searchClearBtn.addEventListener('click', () => {
                elements.searchBar.value = '';
                currentSearchTerm = '';
                elements.searchClearBtn.style.display = 'none';
                renderMainGrid();
            });
            
            elements.modalClose.addEventListener('click', hideModal);
            elements.modalBackdrop.addEventListener('click', hideModal);
            
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && elements.modal.classList.contains('active')) {
                    hideModal();
                }
            });

            // Initialize
            function initialize() {
                const savedTheme = localStorage.getItem('aidefendTheme') || 'dark';
                applyTheme(savedTheme);
                
                // Set about button with icon
                const aboutIcon = createElement('span');
                setIcon(aboutIcon, 'info');
                const svg = aboutIcon.querySelector('svg');
                if (svg) {
                    svg.style.width = '1rem';
                    svg.style.height = '1rem';
                    svg.style.marginRight = '0.5rem';
                }
                elements.aboutBtn.textContent = 'About';
                elements.aboutBtn.insertBefore(aboutIcon, elements.aboutBtn.firstChild);
                
                renderMainGrid();
            }

            initialize();
        });
    </script>
</body>
</html>